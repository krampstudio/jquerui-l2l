/* jqueryui-l2l 
 Bertrand Chevrier chevrier.bertrand@gmail.com copyright 2013 
 @license GPL http://www.gnu.org/licenses/gpl-3.0.txt 
*/
!function(a,b){"use strict";a.widget("ks.l2l",{options:{icons:{l2r:"ui-icon-triangle-1-e",r2l:"ui-icon-triangle-1-w",clear:"ui-icon-trash",grip:"ui-icon-grip-dotted-vertical"},width:"auto",height:"auto",clear:"right",interconnect:!1},_create:function(){if(!this.element.hasClass("l2l")){if(this.lists=this.element.children("ul"),2!=this.lists.length)return a.error("The l2l element must contains 2 lists as direct child"),!1;this.llist=a(this.lists.get(0)),this.rlist=a(this.lists.get(1)),this.element.addClass("l2l"),this.lists.addClass("l2l-list ui-widget-content ui-corner-all"),this.lists.find("li").addClass("l2l-list-item ui-state-default ui-corner-all").prepend(this._iconHtml("grip")),this.llist.after(this._controlsHtml()),this._updateSize(),this.lists.selectable({filter:"li",cancel:".ui-icon",selecting:function(b,c){a(c.selecting).addClass("ui-state-hover")},selected:function(b,c){a(c.selected).addClass("ui-state-active").removeClass("ui-state-default ui-state-hover")},unselected:function(b,c){a(c.unselected).removeClass("ui-state-active").addClass("ui-state-default")}}).sortable({handle:".ui-icon",placeholder:"ui-state-highlight",opacity:.7,connectWith:this.options.interconnect===!0?".l2l-list":this.lists}).draggable({connectToSortable:this.options.interconnect===!0?".l2l-list":this.lists,helper:"clone",scroll:!1,handle:".ui-icon",revert:"invalid",zIndex:1e3,opacity:.7}),this._on(this._events)}},_events:{"click .l2l-ctrl > li":function(c){c.preventDefault();var d="_"+a(c.currentTarget).attr("id");this[d]!==b&&"function"==typeof this[d]&&this[d](c)}},_l2r:function(a){this.llist.find(".ui-selected").appendTo(this.rlist),this._change(a)},_r2l:function(a){this.rlist.find(".ui-selected").appendTo(this.llist),this._change(a)},_clear:function(b){if(this.options.clear!==!1){var c="all"===this.options.clear?this.lists:"left"===this.options.clear?this.llist:this.rlist;a(".ui-selected",c).remove(),this._change(b)}},_change:function(a){this._trigger("change",a,this._getItems())},_getItems:function(){return{left:this.llist.find("li"),right:this.rlist.find("li")}},_updateSize:function(){if(this.options.width&&"auto"!==this.options.width){var b=this.options.width;a.isNumeric(this.options.width)&&(b+="px"),this.lists.width(b)}if(this.options.height)if("auto"===this.options.height){var c=parseInt(this.llist.height(),10),d=parseInt(this.rlist.height(),10);this.lists.css("min-height",Math.max(c,d)+"px")}else{var e=this.options.height;a.isNumeric(this.options.height)&&(e+="px"),this.lists.height(e)}},_controlsHtml:function(){var a="<ul class='l2l-ctrl'><li id='l2r' class='ui-state-default ui-corner-all'>"+this._iconHtml("l2r")+"</li>"+"<li id='r2l' class='ui-state-default ui-corner-all'>"+this._iconHtml("r2l")+"</li>";return this.options.clear!==!1&&(a+="<li id='clear' class='ui-state-default ui-corner-all'>"+this._iconHtml("clear")+"</li>"),a+="</ul>"},_iconHtml:function(a){return"<span class='ui-icon "+this.options.icons[a]+"'></span>"}})}(jQuery);